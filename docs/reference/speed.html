<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate the average speed of a tracked animal — speed • ctmm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate the average speed of a tracked animal — speed" />
<meta property="og:description" content="Given a ctmm movement model and telemetry data, speed simulates multiple realizations of the individual's trajectory to estimate the time-averaged speed, which is proportional to distance traveled, while speeds estimates instantaneous speeds at a specified array of times t. Both tortuosity (non straight-line motion between the data) and telemetry error can be accounted for. Given only a ctmm movement model and no data, speed calculates the mean speed of the Gaussian movement process. All methods are described in Noonan &amp;amp; Fleming et al (2019)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctmm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/error.html">Telemetry Error</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ctmm-initiative/ctmm">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the average speed of a tracked animal</h1>
    
    <div class="hidden name"><code>speed.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a <code>ctmm</code> movement model and <code>telemetry</code> data, <code>speed</code> simulates multiple realizations of the individual's trajectory to estimate the time-averaged speed, which is proportional to distance traveled, while <code>speeds</code> estimates instantaneous speeds at a specified array of times <code>t</code>. Both tortuosity (non straight-line motion between the data) and telemetry error can be accounted for. Given only a <code>ctmm</code> movement model and no data, <code>speed</code> calculates the mean speed of the Gaussian movement process. All methods are described in Noonan &amp; Fleming et al (2019).</p>
    </div>

    <pre class="usage"><span class='fu'>speed</span><span class='op'>(</span><span class='va'>object</span>,<span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for ctmm</span>
<span class='fu'>speed</span><span class='op'>(</span><span class='va'>object</span>,data<span class='op'>=</span><span class='cn'>NULL</span>,t<span class='op'>=</span><span class='cn'>NULL</span>,level<span class='op'>=</span><span class='fl'>0.95</span>,robust<span class='op'>=</span><span class='cn'>FALSE</span>,units<span class='op'>=</span><span class='cn'>TRUE</span>,prior<span class='op'>=</span><span class='cn'>TRUE</span>,fast<span class='op'>=</span><span class='cn'>TRUE</span>,
      cor.min<span class='op'>=</span><span class='fl'>0.5</span>,dt.max<span class='op'>=</span><span class='cn'>NULL</span>,error<span class='op'>=</span><span class='fl'>0.01</span>,cores<span class='op'>=</span><span class='fl'>1</span>,<span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for telemetry</span>
<span class='fu'>speed</span><span class='op'>(</span><span class='va'>object</span>,<span class='va'>CTMM</span>,t<span class='op'>=</span><span class='cn'>NULL</span>,level<span class='op'>=</span><span class='fl'>0.95</span>,robust<span class='op'>=</span><span class='cn'>FALSE</span>,units<span class='op'>=</span><span class='cn'>TRUE</span>,prior<span class='op'>=</span><span class='cn'>TRUE</span>,fast<span class='op'>=</span><span class='cn'>TRUE</span>,
      cor.min<span class='op'>=</span><span class='fl'>0.5</span>,dt.max<span class='op'>=</span><span class='cn'>NULL</span>,error<span class='op'>=</span><span class='fl'>0.01</span>,cores<span class='op'>=</span><span class='fl'>1</span>,<span class='va'>...</span><span class='op'>)</span>

<span class='fu'>speeds</span><span class='op'>(</span><span class='va'>object</span>,<span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for ctmm</span>
<span class='fu'>speeds</span><span class='op'>(</span><span class='va'>object</span>,data<span class='op'>=</span><span class='cn'>NULL</span>,t<span class='op'>=</span><span class='cn'>NULL</span>,cycle<span class='op'>=</span><span class='cn'>Inf</span>,level<span class='op'>=</span><span class='fl'>0.95</span>,robust<span class='op'>=</span><span class='cn'>FALSE</span>,prior<span class='op'>=</span><span class='cn'>FALSE</span>,fast<span class='op'>=</span><span class='cn'>TRUE</span>,
       error<span class='op'>=</span><span class='fl'>0.01</span>,cores<span class='op'>=</span><span class='fl'>1</span>,<span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for telemetry</span>
<span class='fu'>speeds</span><span class='op'>(</span><span class='va'>object</span>,<span class='va'>CTMM</span>,t<span class='op'>=</span><span class='cn'>NULL</span>,cycle<span class='op'>=</span><span class='cn'>Inf</span>,level<span class='op'>=</span><span class='fl'>0.95</span>,robust<span class='op'>=</span><span class='cn'>FALSE</span>,prior<span class='op'>=</span><span class='cn'>FALSE</span>,fast<span class='op'>=</span><span class='cn'>TRUE</span>,
       error<span class='op'>=</span><span class='fl'>0.01</span>,cores<span class='op'>=</span><span class='fl'>1</span>,<span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <code>ctmm</code> movement-model or <code>telemetry</code> object, which requires an additional <code>CTMM</code> argument.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Optional <code>telemetry</code> object on which the simulations will be conditioned.</p></td>
    </tr>
    <tr>
      <th>CTMM</th>
      <td><p>Movement model object.</p></td>
    </tr>
    <tr>
      <th>t</th>
      <td><p>Array of times to estimate instantaneous speeds at, or range of times to estimate mean speed over.</p></td>
    </tr>
    <tr>
      <th>cycle</th>
      <td><p>Average over time <code>t</code> indices modulo <code>cycle</code>. E.g., for <code>t</code> sequenced by hours, <code>cycle=24</code> gives daily the cycle of speeds. (Not yet supported.)</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>Confidence level to report on the estimated average speed.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>Use robust statistics for the ensemble average and its confidence intervals (see Details).</p></td>
    </tr>
    <tr>
      <th>units</th>
      <td><p>Convert result to natural units.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>Account for model parameter uncertainty.</p></td>
    </tr>
    <tr>
      <th>fast</th>
      <td><p>Whether or not to invoke the central-limit theorem when propagating parameter uncertainty (see <code><a href='emulate.html'>emulate</a></code>).</p></td>
    </tr>
    <tr>
      <th>cor.min</th>
      <td><p>Velocity correlation threshold for skipping gaps.</p></td>
    </tr>
    <tr>
      <th>dt.max</th>
      <td><p>Absolute gap sizes to skip (in seconds), alternative to <code>cor.min</code>.</p></td>
    </tr>
    <tr>
      <th>error</th>
      <td><p>Target (relative) standard error.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Number of simulations to run in parallel. <code>cores=0</code> will use all cores, while <code>cores&lt;0</code> will reserve <code><a href='https://rdrr.io/r/base/MathFun.html'>abs(cores)</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to <code><a href='emulate.html'>emulate</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>cor.min</code> or <code>dt.max</code> arguments are used to constrain the estimate to be derived from simulations near the data, and therefore ensure that the estimate is more reflective of the data than the model.</p>
<p>If data quality is poor and velocity can barely be resolved, then the sampling distribution may occassionally include impersistent motion and its mean will be infinite. In these cases <code>robust=TRUE</code> can be used to report the sampling distribution's median rather than its mean. The time average of <code>speed</code>, in either case, is still the mean average of times and the resulting quantity is still proportional to distance traveled. Furthermore, note that medians should be compared to medians and means to means, so the <code>robust</code> option should be the same for all compared individuals.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns the estimated mean speed of the sampled trajectory with CIs by default. If <code>level=NULL</code>, then the ensemble of mean speeds is returned instead.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>M. J. Noonan, C. H. Fleming, T. S. Akre, J. Drescher-Lehman, E. Gurarie, A.-L. Harrison, R. Kays, Justin Calabrese,
``Scale-insensitive estimation of speed and distance traveled from animal tracking data'',
<a href='https://movementecologyjournal.biomedcentral.com/articles/10.1186/s40462-019-0177-1'>Movement Ecology, 7:35 (2019)</a>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>C. H. Fleming.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The average speeds estimated here are mean speeds. The speeds reported by <code><a href='summary.ctmm.html'>summary.ctmm</a></code> are root-mean-square (RMS) speeds. These quantities are sometimes proportional, but not equivalent.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='emulate.html'>emulate</a></code>, <code><a href='simulate.ctmm.html'>simulate</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'># Load package and data</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/ctmm-initiative/ctmm'>ctmm</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>buffalo</span><span class='op'>)</span>
<span class='va'>Gabs</span> <span class='op'>&lt;-</span> <span class='va'>buffalo</span><span class='op'>$</span><span class='va'>Gabs</span>

<span class='va'>GUESS</span> <span class='op'>&lt;-</span> <span class='fu'><a href='variogram.fit.html'>ctmm.guess</a></span><span class='op'>(</span><span class='va'>Gabs</span>,interactive<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>FIT</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ctmm.html'>ctmm.fit</a></span><span class='op'>(</span><span class='va'>Gabs</span>,<span class='va'>GUESS</span><span class='op'>)</span>

<span class='co'># stationary Gaussian estimate</span>
<span class='fu'>speed</span><span class='op'>(</span><span class='va'>FIT</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                             low      est     high
#&gt; speed (kilometers/day) 11.82123 12.16713 12.51548</div><div class='input'>
<span class='co'># conditional estimate</span>
<span class='fu'>speed</span><span class='op'>(</span><span class='va'>FIT</span>,<span class='va'>Gabs</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt;                             low      est     high
#&gt; speed (kilometers/day) 11.03669 11.46068 11.88858</div><div class='input'><span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


