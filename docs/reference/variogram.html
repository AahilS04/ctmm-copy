<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate an empirical variogram from movement data
 — variogram • ctmm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">ctmm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://cran.r-project.org/web/packages/ctmm/vignettes/variogram.html">Vignette - Variograms</a>
</li>
<li>
  <a href="https://cran.r-project.org/web/packages/ctmm/vignettes/akde.html">Vignette - akde</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate an empirical variogram from movement data
</h1>
    </div>

    
    <p>This function calculates the isotropic empirical variogram of two-dimensional tracking data for visualizing stationary (time-averaged) autocorrelation structure.
One of two algorithms is used. The slow \(O(n^2)\) algorithm is based upon the lag-weighted variogram of Fleming et al (2014).
Additional modifications have also been included to accommodate any drift in the sampling rate.
The fast \(O(n \log n)\) algorithm is based upon the FFT method of Marcotte (1996), with some tweaks to better handle irregularly sampled data.
Both methods reduce to the standard &#8220;method of moments&#8221; estimator in the case of evenly <em>scheduled</em> data, even with missing observations, but they produce slightly different outputs for irregularly sampled data.</p>
    

    <pre><span class='fu'>variogram</span>(<span class='no'>data</span>,<span class='kw'>dt</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>fast</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>CI</span><span class='kw'>=</span><span class='st'>"Markov"</span>,<span class='kw'>axes</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"x"</span>,<span class='st'>"y"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>data</dt>
      <dd> <code>telemetry</code> data object of the 2D timeseries data. </dd>
      <dt>dt</dt>
      <dd> Lag bin width. An ordered array will yield a progressive coarsening of the lags. Defaults to the median sampling interval.</dd>
      <dt>fast</dt>
      <dd> Use the lag-weighted algorithm if <code>FALSE</code> or the FFT algorithm if <code>TRUE</code>. The slow algorithm outputs a progress bar.</dd>
      <dt>CI</dt>
      <dd>Defaults to only consider non-overlapping lags independent. All unique lags are considered independent with &quot;IID&quot;.</dd>
      <dt>axes</dt>
      <dd>Array of axes to calculate an average (isotropic) variogram for.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If no <code>dt</code> is specified, the median sampling interval is used. This is typically a good assumption for most data, even when there are gaps. A <code>dt</code> coarser than the sampling interval may bias the variogram (particuarly if <code>fast=TRUE</code>) and so this should be reserved for poor data quality.</p>
    <p>For irregularly sampled data, it may be useful to provide an array of time-lag bin widths to progressively coarsen the variogram. I.e., if you made the very bad choice of changing your sampling interval on the fly from <code>dt1</code> to <code>dt2</code>, where <code>dt1</code> \(&lt;\) <code>dt2</code>, the an appropriate choice would be <code>dt=c(dt1,dt2)</code>. On the other hand, if your sampling is itself a noisy process, then you might want to introduce larger and larger <code>dt</code> components as the visual appearance of the variogram breaks down with increasing lags.
Alternatively, you might try the <code>fast=FALSE</code> option or aggregating multiple individuals with <code><a href='mean.variogram.html'>mean.variogram</a></code>.</p>
    <p>In standard variogram regression treatments, all lags are considered as independent (<code>CI=&quot;IID&quot;</code>) for the purposes of confidence-interval estimation, even if they overlap in time. However, in high resolution datasets this will produce vastly underestimated confidence intervals. Therefore, the default <code>CI=&quot;Markov&quot;</code> behavior is to consider only the maximum number of non-overlapping lags in calculating confidence intervals.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a variogram object (class variogram) which is a dataframe containing the time-lag, <code>lag</code>, the semi-variance estimate at that lag, <code>SVF</code>, and the approximate number of degrees of freedom associated with that semi-variance, <code>DOF</code>, with which its confidence intervals can be estimated.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>C. H. Fleming, J. M. Calabrese, T. Mueller, K.A. Olson, P. Leimgruber, and W. F. Fagan. (2014). From fine-scale foraging to home ranges: A semi-variance approach to identifying movement modes across spatiotemporal scales. <a href = 'The American Naturalist, 183(5), E154-E167'>http://www.jstor.org/discover/10.1086/675504</a>.</p>
    <p>D. Marcotte. (1996). Fast variogram computation with FFT. <em>Computers and Geosciences</em> 22(10), 1175-1186.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>vignette(&quot;variogram&quot;)</code>, <code><a href='mean.variogram.html'>mean.variogram</a></code>, <code><a href='plot.variogram.html'>plot.variogram</a></code>, <code><a href='variogram.fit.html'>variogram.fit</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Load package and data</span>
<span class='fu'>library</span>(<span class='no'>ctmm</span>)
<span class='fu'>data</span>(<span class='no'>buffalo</span>)

<span class='co'>#Extract movement data for a single animal</span>
<span class='no'>cilla</span> <span class='kw'>&lt;-</span> <span class='no'>buffalo</span><span class='kw'>[[</span><span class='fl'>1</span>]]

<span class='co'>#Calculate variogram</span>
<span class='no'>SVF</span> <span class='kw'>&lt;-</span> <span class='fu'>variogram</span>(<span class='no'>cilla</span>)</div><div class='output co'>#&gt; <span class='error'>Error in NextMethod(&quot;[&quot;): &#39;NextMethod&#39; called from an anonymous function</span></div><div class='input'>
<span class='co'>#Plot the variogram</span>
<span class='fu'><a href='plot.telemetry.html'>plot</a></span>(<span class='no'>SVF</span>)</div><div class='output co'>#&gt; <span class='error'>Error in plot(SVF): object &#39;SVF&#39; not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
     C. H. Fleming and J. M. Calabrese. 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
