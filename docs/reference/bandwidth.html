<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate the optimal bandwidth matrix of movement data — bandwidth â€¢ ctmm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">ctmm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../inst/docs/variogram.html">Variogram vignette</a>
</li>
<li>
  <a href="../../inst/docs/akde.html">AKDE vignette</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ctmm-initiative/ctmm">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the optimal bandwidth matrix of movement data</h1>
    </div>

    
    <p>This function calculates the optimal bandwidth matrix (kernel covariance) for a two-dimensional animal tracking dataset, given an autocorrelated movement model (Fleming et al, 2015). This optimal bandwidth can fully take into account all autocorrelation in the data, assuming it is captured by the movement model.</p>
    

    <pre><span class='fu'>bandwidth</span>(<span class='no'>data</span>,<span class='no'>CTMM</span>,<span class='kw'>VMM</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>weights</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>fast</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
  <span class='kw'>dt</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>precision</span><span class='kw'>=</span><span class='fl'>1</span>/<span class='fl'>2</span>,<span class='kw'>PC</span><span class='kw'>=</span><span class='st'>"Markov"</span>,<span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>data</dt>
      <dd> 2D timeseries telemetry data represented as a <code>telemetry</code> object. </dd>
      <dt>CTMM</dt>
      <dd>A <code>ctmm</code> movement model as from the output of <code>ctmm.fit</code>.</dd>
      <dt>VMM</dt>
      <dd>An optional vertical <code>ctmm</code> object for 3D bandwidth calculation.</dd>
      <dt>weights</dt>
      <dd>By default, the weights are taken to be uniform. <code>weights=TRUE</code> will optimize the weights, while a <code>numeric</code> array will fix the weights.</dd>
      <dt>fast</dt>
      <dd>Use FFT algorithms for weight optimization.</dd>
      <dt>dt</dt>
      <dd> Optional lag bin width for the FFT algorithm.</dd>
      <dt>precision</dt>
      <dd>Fraction of maximum possible digits of precision to target in weight optimization. <code>precision=1/2</code> results in about 7 decimal digits of precision if the preconditioner is stable.</dd>
      <dt>PC</dt>
      <dd>Preconditioner to use: can be &quot;Markov&quot;, &quot;circulant&quot;, &quot;IID&quot;, or &quot;direct&quot;.</dd>
      <dt>verbose</dt>
      <dd> Optionally return the optimal <code>weights</code>, effective sample size <code>DOF.H</code>, and other information along with the bandwidth matrix <code>H</code>.</dd>
      <dt>trace</dt>
      <dd>Produce tracing information on the progress of weight optimization.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>weights</code> argument can be used to correct fixed sampling bias with a prescribed <code>numeric</code> array or to correct temporal sampling bias caused by autocorrelation with <code>weights=TRUE</code>.
<code>weights=TRUE</code> will optimize <code>n=length(data$t)</code> weights via constrained &amp; preconditioned conjugate gradient algorithms.
These algorithms have a few options that should be considered if the data are very irregular.</p>
    <p><code>FFT=TRUE</code> grids the data with grid width <code>dt</code> and applies FFT algorithms, for a computational cost as low as \(O(n \log n)\) with only \(O(n)\) function evaluations.
If no <code>dt</code> is specified, the minimum sampling interval is used, but <strong>if the data are very irregular, then <code>dt</code> may need to be several times smaller</strong> to avoid slow down.
A <code>dt</code> Insufficient to resolve the details of the sampling schedule will cause an excessive, \(O(n)\) number of feasibility assessments, which you can check with the <code>trace=TRUE</code> argument.
<!-- %With the sub-optimal \code{PC=&quot;IID&quot;} preconditioner, \code{dt} can be relaxed to the median value, but the computational cost is then increased to \eqn{O(n^2 \log n)}. --></p>
    <p><code>FFT=FALSE</code> uses exact times and has a computational cost as low as \(O(n^2)\), including \(O(n^2)\) function evaluations. With <code>PC=&quot;direct&quot;</code> this method will produce a result that is exact to within machine precision, but with a computational cost of \(O(n^3)\).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a bandwidth <code>matrix</code> object, which is to be the optimal covariance matrix of the individual kernels of the kernel density estimate.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>T. F. Chan (1988).
An Optimal Circulant Preconditioner for Toeplitz Systems.
SIAM Journal on Scientific and Statistical Computing, 9(4), 766-771.</p>
    <p>C. H. Fleming and W. F. Fagan and T. Mueller and K. A. Olson and P. Leimgruber and J. M. Calabrese (2015).
Rigorous home-range estimation with movement data: A new autocorrelated kernel-density estimator.
<a href = 'Ecology, 96(5), 1182-1188'>http://www.esajournals.org/doi/abs/10.1890/14-2010.1</a>.</p>
    <p>D. Marcotte. (1996). Fast variogram computation with FFT. <em>Computers and Geosciences</em> 22(10), 1175-1186.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>To obtain a bandwidth scalar representing the variance of each kernel, a <code>ctmm</code> object with <code>isotropic=TRUE</code> is required.  In this case, <code>bandwidth</code> will return bandwidth matrix with identical variances along its diagonal. Note that this will provide an inaccurate estimate for very eccentric distributions.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='akde.html'>akde</a></code>, <code><a href='ctmm.html'>ctmm.fit</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
     C. H. Fleming. 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
