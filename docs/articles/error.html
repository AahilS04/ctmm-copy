<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telemetry error • ctmm</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Telemetry error">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctmm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/error.html">Telemetry Error</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ctmm-initiative/ctmm">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Telemetry error</h1>
                        <h4 class="author">Christen H. Fleming</h4>
            
            <h4 class="date">2018-10-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ctmm-initiative/ctmm/blob/master/vignettes/error.Rmd"><code>vignettes/error.Rmd</code></a></small>
      <div class="hidden name"><code>error.Rmd</code></div>

    </div>

    
    
<div id="error-calibration" class="section level1">
<h1 class="hasAnchor">
<a href="#error-calibration" class="anchor"></a>Error calibration</h1>
<p>The first step to handling errors is to quantify them. Make sure that your data’s “dilution of precision” (DOP) and error columns import correctly into <code>ctmm</code>. Some tracking device manufacturers provide pre-calibrated errors. These coati were tracked with e-obs GPS collars that features calibrated errors for the location, imported by <code>ctmm</code> into the <code>VAR.xy</code> column, which represents the <code>x</code> and <code>y</code> error variances.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ctmm)
<span class="kw">data</span>(<span class="st">'coati'</span>)
<span class="kw">names</span>(coati[[<span class="dv">1</span>]]) <span class="co"># imported column names</span></code></pre></div>
<pre><code>##  [1] "timestamp" "longitude" "latitude"  "t"         "HDOP"     
##  [6] "VAR.xy"    "z"         "VDOP"      "speed"     "heading"  
## [11] "SDOP"      "VAR.v"     "x"         "y"         "vx"       
## [16] "vy"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.telemetry.html">plot</a></span>(coati[[<span class="dv">1</span>]],<span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">2</span>),<span class="dt">error=</span><span class="dv">2</span>,<span class="dt">trans=</span><span class="fl">0.4</span>) <span class="co"># coati plot with 95% error discs</span></code></pre></div>
<p><img src="error_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>Most GPS devices will only have an <code>HDOP</code> column, which is only proportional to the <code>x</code> and <code>y</code> error standard deviations. The proportionality constant between the HDOP and error standard deviation is known as the user equivalent range error (UERE). The UERE should be estimated from calibration data if not provided by the manufacturer. Without the option of pre-calibrated errors or calibration data, the UERE must be fit simultaneously with the movement model, which is not as reliable. We will cover simultaneous fitting at the end of this vignette.</p>
<p>In the following wood turtle dataset, we have some calibration data and a turtle track. Note that the calibration data must be collected from the same model device as the tracking data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(turtle)
<span class="kw">names</span>(turtle[[<span class="dv">1</span>]]) <span class="co"># data are not yet calibrated</span></code></pre></div>
<pre><code>## [1] "t"    "HDOP" "x"    "y"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(turtle) <span class="co"># two calibration datasets and two turtle datasets</span></code></pre></div>
<pre><code>## [1] "60s"  "90s"  "F231" "F403"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.telemetry.html">plot</a></span>(turtle[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],<span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">2</span>)) <span class="co"># calibration data only</span></code></pre></div>
<p><img src="error_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>The <code>uere</code> command is used to estimate the UERE parameter from calibration data. Do not use this command on animal tracking data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">UERE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/uere.html">uere.fit</a></span>(turtle[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="co"># only using calibration data</span>
<span class="kw">summary</span>(UERE)</code></pre></div>
<pre><code>## , , horizontal
## 
##          low       ML     high
## all 9.940412 10.62878 11.31654</code></pre>
<p>For GPS data, the UERE will typically be 10-15 meters. The UERE can be assigned to a dataset with the <code>uere()&lt;-</code> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/uere.html">uere</a></span>(turtle) &lt;-<span class="st"> </span>UERE
<span class="kw">names</span>(turtle[[<span class="dv">3</span>]]) <span class="co"># now the data are calibrated</span></code></pre></div>
<pre><code>## [1] "t"      "HDOP"   "x"      "y"      "VAR.xy"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.telemetry.html">plot</a></span>(turtle[[<span class="dv">3</span>]],<span class="dt">error=</span><span class="dv">2</span>) <span class="co"># turtle plot with 95% error discs</span></code></pre></div>
<p><img src="error_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div id="error-model-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#error-model-selection" class="anchor"></a>Error model selection</h2>
<p>Not all GPS devices provide reliable DOP values and sometimes it is not obvious what error information will prove to be the most predictive. Generally speaking, <code>as.telemetry</code> will attempt to import the “best” column from among those that estimate error, DOP value, number of satellites and fix type, inlcuding timed-out fixes (see the <code>timeout</code> argument in <code>help(as.telemetry)</code>). Researchers may want to import the data with different error information, run <code>uere.fit</code> for each error model, and then select among the candidate models. Here we do this by comparing the turtle calibration data with and without HDOP values.</p>
<p>First, we remove the HDOP values in an alternate dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">squirtle &lt;-<span class="st"> </span><span class="kw">lapply</span>(turtle,<span class="cf">function</span>(t){ t<span class="op">$</span>HDOP &lt;-<span class="st"> </span><span class="ot">NULL</span> ; t })</code></pre></div>
<p>In other cases, manipulation will need to be performed before importing, so that <code>as.telemetry</code> can format the <code>telemetry</code> object properly. Running <code>uere.fit</code> now results in errors calibrated under the assumption of homoskedastic errors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">UERE2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/uere.html">uere.fit</a></span>(squirtle[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</code></pre></div>
<p>We can now apply model selection to the two UERE fits by summarizing them in a list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">list</span>(<span class="dt">HDOP=</span>UERE,<span class="dt">homo=</span>UERE2))</code></pre></div>
<pre><code>##         ΔAICc  Z[red]²
## HDOP   0.0000 6.179499
## homo 350.6833 7.403003</code></pre>
<p>Now we can see that the HDOP values yield the better error model, both in terms of AICc and in terms of reduced Z squared, which is a goodness-of-fit statistic akin to reduced chi squared but designed for comparing error models.</p>
</div>
</div>
<div id="outlier-detection" class="section level1">
<h1 class="hasAnchor">
<a href="#outlier-detection" class="anchor"></a>Outlier detection</h1>
<p>Now we come to the task of identifying outliers. The <code>outlie</code> function uses error information to estimate straight-line speeds between sampled times and distances from the bulk of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/outlie.html">outlie</a></span>(turtle[[<span class="dv">3</span>]]) -&gt;<span class="st"> </span>OUT</code></pre></div>
<p><img src="error_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>High-speed segments are colored in blue, while distant locations are colored in red. More emphasis is placed on the more extreme locations in the <code>outlie</code> plot. Visually we can see at least one outlier in the wood turtle data. The output of <code>outlie</code> also contains the error-informed speed and distance estimates (in SI units) used to generate the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.telemetry.html">plot</a></span>(OUT)</code></pre></div>
<p><img src="error_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>A sustained speed of 0.1 m/s is not biologically implausible for a wood turtle, but this location is highly suspicious, both in terms of speed and lack of proximity. After removing the outlier, we can check the data again.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">BAD &lt;-<span class="st"> </span><span class="kw">which.max</span>(OUT<span class="op">$</span>speed)
turtle[[<span class="dv">3</span>]] &lt;-<span class="st"> </span>turtle[[<span class="dv">3</span>]][<span class="op">-</span>BAD,]
<span class="kw"><a href="../reference/outlie.html">outlie</a></span>(turtle[[<span class="dv">3</span>]]) -&gt;<span class="st"> </span>OUT</code></pre></div>
<p><img src="error_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Datasets may have multiple outliers. In pathological situations, there may be no clear separation between the normative data and the outliers. This necessitates a better error model, either by improving inadequate (or absent) HDOP estimates or by employing a heavier tailed error distribution (not yet supported).</p>
</div>
<div id="variograms-and-model-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#variograms-and-model-selection" class="anchor"></a>Variograms and model selection</h1>
<div id="variograms" class="section level2">
<h2 class="hasAnchor">
<a href="#variograms" class="anchor"></a>Variograms</h2>
<p>If we were working with ARGOS data or high resolution GPS data on a small animal, then we can get a “nugget” effect in the variogram that looks like an initial discontinuity at short time lags.</p>
<p><img src="error_files/figure-html/unnamed-chunk-11-1.png" width="700"><img src="error_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
<p>The height of this initial discontinuity corresponds to the variance of uncorrelated location errors. The second plot is the kind of initial discontinuity one has with detector array data. The end of the (slope) discontinuity is highlighted with a circle. This discontinuity is smooth because the movement and detection are correlated. The height of this initial discontinuity is also (at least roughly) the variance of the location errors.</p>
</div>
<div id="model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fitting" class="anchor"></a>Model fitting</h2>
<p>Because of some convenient mathematical relations, fitting with telemetry errors involves numerically fitting 1-4 more parameters and is, therefore, slower and less reliable at converging on the MLE than fitting without telemetry error. Therefore, by default, telemetry error is not turned on in <code>ctmm</code> models (<code>error=FALSE</code>). Furthermore, in cases with an error model, <code><a href="../reference/ctmm.fit.html">ctmm.select()</a></code> is safer to use than direct applicaiton of <code><a href="../reference/ctmm.fit.html">ctmm.fit()</a></code>, because <code><a href="../reference/ctmm.fit.html">ctmm.select()</a></code> will start with the simplest “compatible” model and then consider further model features that require numerical optimization in stepwise fashion.</p>
<div id="fitting-with-calibrated-data" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-with-calibrated-data" class="anchor"></a>Fitting with calibrated data</h3>
<p>For calibrated errors, we have to set <code>error=TRUE</code> in the model guess to fit with telemetry error accounted for.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># automated guestimates with circular covariance and calibrated errors</span>
GUESS &lt;-<span class="st"> </span><span class="kw"><a href="../reference/variogram.fit.html">ctmm.guess</a></span>(turtle[[<span class="dv">3</span>]],<span class="dt">CTMM=</span><span class="kw"><a href="../reference/ctmm.fit.html">ctmm</a></span>(<span class="dt">error=</span><span class="ot">TRUE</span>),<span class="dt">interactive=</span><span class="ot">FALSE</span>)
<span class="co"># the beta optimizer is more reliable than the default optimizer</span>
<span class="co"># control &lt;- list(method='pNewton',cores=-1) # will use all but one cores</span>
control &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">method=</span><span class="st">'pNewton'</span>,<span class="dt">cores=</span><span class="dv">2</span>) <span class="co"># CRAN policy limits us to 2 cores</span>
<span class="co"># stepwise fitting</span>
FIT &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ctmm.fit.html">ctmm.select</a></span>(turtle[[<span class="dv">3</span>]],GUESS,<span class="dt">control=</span>control,<span class="dt">trace=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## * Fitting model OUF isotropic error.</code></pre>
<pre><code>## * Fitting models OUF anisotropic error.</code></pre>
<pre><code>## * Fitting models OU anisotropic error, OUf anisotropic error.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(FIT)</code></pre></div>
<pre><code>## $name
## [1] "OU anisotropic error"
## 
## $DOF
##     mean     area    speed 
## 12.59923 24.41652  0.00000 
## 
## $CI
##                          low        ML     high
## area (hectares)    12.192645 18.949153 27.17140
## τ[position] (days)  3.693129  6.319045 10.81206</code></pre>
<p><code>trace=TRUE</code> allows us to see the models considered. <code>verbose=TRUE</code> would save each model.</p>
</div>
<div id="fitting-with-uncalibrated-data" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-with-uncalibrated-data" class="anchor"></a>Fitting with uncalibrated data</h3>
<p>Fitting with unknown errors is a method of last resort. We have to provide an initial guess for <code>error</code>, which will be the device’s UERE. <code>error=10</code> is usually a good guess for GPS data. Let’s consider the turtle data again, but without calibrated UERE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># delete UERE information</span>
<span class="kw"><a href="../reference/uere.html">uere</a></span>(turtle[[<span class="dv">3</span>]]) &lt;-<span class="st"> </span><span class="ot">NULL</span></code></pre></div>
<p>The only difference is that you have to provide an initial guess for the UERE. Otherwise, the steps are the same.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cheat and use previous fit as initial guess</span>
GUESS<span class="op">$</span>error &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co"># 10 meter error guess</span>
<span class="co"># fit parameter estimates</span>
FIT &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ctmm.fit.html">ctmm.select</a></span>(turtle[[<span class="dv">3</span>]],GUESS,<span class="dt">control=</span>control)
<span class="kw">summary</span>(FIT)</code></pre></div>
<pre><code>## $name
## [1] "OU anisotropic error"
## 
## $DOF
##     mean     area    speed 
## 13.46152 25.98180  0.00000 
## 
## $CI
##                          low        ML      high
## area (hectares)    12.604531 19.298795 27.396166
## τ[position] (days)  3.467312  5.882935  9.981486
## error (meters)      0.000000  9.317617 63.303346</code></pre>
<p>Here, fitting the UERE simultaneously with the movement model produced a consistent result. This will not always be the case.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#error-calibration">Error calibration</a><ul class="nav nav-pills nav-stacked">
<li><a href="#error-model-selection">Error model selection</a></li>
      </ul>
</li>
      <li><a href="#outlier-detection">Outlier detection</a></li>
      <li>
<a href="#variograms-and-model-selection">Variograms and model selection</a><ul class="nav nav-pills nav-stacked">
<li><a href="#variograms">Variograms</a></li>
      <li><a href="#model-fitting">Model fitting</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
